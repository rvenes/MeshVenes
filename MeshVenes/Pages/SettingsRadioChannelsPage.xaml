<Page
    x:Class="MeshVenes.Pages.SettingsRadioChannelsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid RowDefinitions="Auto,8,Auto,8,Auto,8,Auto,8,*">
        <TextBlock Text="Channels" FontSize="22" FontWeight="SemiBold"/>
        <TextBlock Grid.Row="2" x:Name="StatusText" Opacity="0.85" Text="Loading..."/>

        <StackPanel Grid.Row="4" Orientation="Horizontal" Spacing="8">
            <Button Content="Reload" Click="Reload_Click"/>
            <Button Content="Save all" Click="Save_Click"/>
        </StackPanel>

        <TextBlock Grid.Row="6"
                   Opacity="0.85"
                   TextWrapping="Wrap"
                   Text="Name is a human-readable label. PSK must match between nodes for private channel traffic. Channel ID is advanced and should only be changed when you know your target values. Role must be Primary/Secondary to enable the channel."/>

        <ListView Grid.Row="8" x:Name="ChannelsList" ItemsSource="{x:Bind Rows, Mode=OneWay}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Border BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,8" BorderBrush="#33FFFFFF">
                        <Grid ColumnDefinitions="120,150,120,220,130,90,180"
                              RowSpacing="6"
                              ColumnSpacing="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Column="0" VerticalAlignment="Center" Text="Index"/>
                            <TextBlock Grid.Column="1" VerticalAlignment="Center" Text="{Binding Index}"/>

                            <TextBlock Grid.Column="2" VerticalAlignment="Center" Text="Role"/>
                            <ComboBox Grid.Column="3" Width="220" SelectedIndex="{Binding RoleIndex, Mode=TwoWay}">
                                <ComboBoxItem Content="Disabled"/>
                                <ComboBoxItem Content="Primary"/>
                                <ComboBoxItem Content="Secondary"/>
                            </ComboBox>

                            <TextBlock Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Text="Name"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" Text="{Binding Name, Mode=TwoWay}"/>

                            <TextBlock Grid.Row="1" Grid.Column="4" VerticalAlignment="Center" Text="Uplink"/>
                            <CheckBox Grid.Row="1" Grid.Column="5" IsChecked="{Binding UplinkEnabled, Mode=TwoWay}" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Text="Key size"/>
                            <ComboBox Grid.Row="2"
                                      Grid.Column="1"
                                      Width="200"
                                      SelectedIndex="{Binding PskPresetIndex, Mode=TwoWay}">
                                <ComboBoxItem Content="Empty"/>
                                <ComboBoxItem Content="Default (AQ==)"/>
                                <ComboBoxItem Content="1 byte"/>
                                <ComboBoxItem Content="128 bit"/>
                                <ComboBoxItem Content="256 bit"/>
                            </ComboBox>
                            <Button Grid.Row="2"
                                    Grid.Column="2"
                                    Width="90"
                                    Content="Generate"
                                    Click="GeneratePsk_Click"/>

                            <TextBlock Grid.Row="2" Grid.Column="4" VerticalAlignment="Center" Text="Downlink"/>
                            <CheckBox Grid.Row="2" Grid.Column="5" IsChecked="{Binding DownlinkEnabled, Mode=TwoWay}" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Text="PSK (base64)"/>
                            <TextBox Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="6" Text="{Binding PskBase64, Mode=TwoWay}"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" VerticalAlignment="Center" Text="Channel ID"/>
                            <TextBox Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" Text="{Binding ChannelIdText, Mode=TwoWay}"/>

                            <TextBlock Grid.Row="4" Grid.Column="4" VerticalAlignment="Center" Text="Allow position requests"/>
                            <CheckBox Grid.Row="4" Grid.Column="5" IsChecked="{Binding AllowPositionRequests, Mode=TwoWay}" VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="5" Grid.Column="0" VerticalAlignment="Center" Text="Precise location"/>
                            <CheckBox Grid.Row="5"
                                      Grid.Column="1"
                                      IsChecked="{Binding PreciseLocation, Mode=TwoWay}"
                                      IsEnabled="{Binding CanUsePreciseLocation}"
                                      VerticalAlignment="Center"/>

                            <TextBlock Grid.Row="5" Grid.Column="2" VerticalAlignment="Center" Text="Approximate location"/>
                            <Slider Grid.Row="5"
                                    Grid.Column="3"
                                    Grid.ColumnSpan="2"
                                    Minimum="12"
                                    Maximum="15"
                                    StepFrequency="1"
                                    Value="{Binding ApproximatePositionPrecision, Mode=TwoWay}"
                                    IsEnabled="{Binding IsApproximateControlEnabled}"/>
                            <TextBlock Grid.Row="5"
                                       Grid.Column="6"
                                       VerticalAlignment="Center"
                                       Text="{Binding ApproximatePositionLabel}"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </Grid>
</Page>
